{% comment %} 연도별로 그래프를 생성합니다. 여기서는 2025년과 2024년을 예시로 보여줍니다. {% endcomment %}
{% assign years = "2025,2024" | split: "," %}

<div class="contribution-graph-container">
  {% for year in years %}
  {%- assign books_this_year = site.posts | where_exp: "item", "item.category == 'book' and item.read_date and item.read_date contains year" -%}
  {%- assign books_by_month = books_this_year | group_by_exp: "item", "item.read_date" | sort: "name" -%}

  {% if books_by_month.size > 0 %}
  <div class="contribution-graph">
    <h3>{{ year }}</h3>
    <div class="months-grid">
      {% for i in (1..12) %}
      {%- assign month_num = i | prepend: '0' | slice: -2, 2 -%}
      {%- assign month_key = year | append: "-" | append: month_num -%}

      {%- assign count = 0 -%}
      {%- for group in books_by_month -%}
      {%- if group.name == month_key -%}
      {%- assign count = group.items | size -%}
      {%- endif -%}
      {%- endfor -%}

      {%- assign level = count | at_most: 5 -%}

      <div class="month-cell level-{{ level }}" title="{{ month_key }}: {{ count }}권">
        <span class="month-label">{{ month_num }}월</span>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
  {% endfor %}
</div>
